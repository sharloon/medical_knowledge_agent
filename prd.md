基于 RAG 和智能体技术的糖尿病诊断医疗助手

## 1.作业要求:

基于《高血压诊疗指南.pdf》、《中国高血压防治指南.pdf》、《糖尿病病例统计.xlsx》以及 MySQL 医疗数据库，构建专家级医疗决策支持智能体，实现临床诊疗全流程决策支持。 

【核心功能要求】:
多源数据整合:系统需整合 PDF 指南、Excel 统计数据、MySQL 数据库，实现统一的知识检索和决策支持

专家决策引擎:智能体需具备临床推理能力，能根据患者数据生成个性化诊疗方案

安全风险控制:内置医学伦理和安全校验机制，对高风险操作进行预警

功能界面：提供网站，实现多个功能点，可以包含对话窗口及每个细项功能的快速入口

验证：对于每个细项需求，需要能给出明确的测试步骤，以证明符合验收要求

## 2. 数据说明:

1. data 目录:存放 rag 需要的文档

2. db 目录存放 mysql 的建表语句 ddl.sql，数据内容已经导入到库里, 数据库信息：rm-bp1y35g510t57uexqlo.mysql.rds.aliyuncs.com:3306
账号：logcloud 密码：Logcloud4321

【建议】: mysql 采用 mcp 协议

## 3.作业提交要求:

1. 对于每个需求，需要能给出明确的测试步骤，以证明符合验收要求

## 4.专家智能体优化版评分标准(总分 100 分) 

4.1.基础数据层建设（大菜单：基础数据检索）(25 分)

##### 4.1.1.PDF 知识库构建 (5 分)

- 功能点：提取文档目录结构及关键表格，如提取《高血压诊疗指南.pdf》目录结构及关键表格，注意pdf中含有图片表格(2 分)

- 功能点：术语标准化映射，如输入"心梗"检索到"心肌梗死"，并展示列出映射表 (3 分)

#### 4.1.2. Excel 数据处理 (3 分)

- 功能点：解析excel中数据分布，实现解析《糖尿病病例统计.xlsx》中"胰岛素使用率"数据分布，截图展示基础可视化(3 分)

说明:

A、空腹胰岛素和餐后 2 小时胰岛素中得没有值或者为空说明没有测量, 2 个都没有, 就是没有用胰岛素

B、这个表格里面得人都是糖尿病人，共有 125 人

C、数据分布，简单点，就选性别，男女即可，如果自己想做好点，可以做年龄段、身高、 体重，不做更多维度要求



#### 4.1.4. 多模态数据整合 (7 分)

- 功能点：智能对话，实现 PDF+Excel+MySQL 的统一检索接口，截图展示"高血压急症处理"的跨源检索结果(4 分)

- 功能点：指南文档时效性验证，，如检索 2025 年 7 月 20 日后更新的指南文档，从Mysql的指南推荐规则表中按照指南更新日期过滤(3 分)

#### 4.1.5. 系统基础功能(5 分)

- 功能点：智能对话-错误提示，无知识库时显示专业的错误提示，例如输入:骨折怎么治疗，直接显示无此类信息 (2 分)

- 功能点：智能对话，有知识库时返回正确信息，例如输入:什么是高血压，直接给出专业定义(3 分)

#### 4.1.6. 系统运维 (2 分)

- 功能点：后台定时自动更新文档rag保存索引，建议间隔2分钟，如《中国高血压防治指南.pdf》新增文档后自动重建索引，截图日志显示更新时间戳 (2 分)

## 4.2.专家智能体核心能力 (55 分)

#### 4.2.1. 临床数据查询与分析（大菜单：临床数据查询与分析，以智能对话方式完成下述功能） (15 分)

- 患者画像构建，输入患者ID(字符串)，智能体自动查询 MySQL 生成完整患者画像(年龄、 性别、病史、用药、检查结果)(5 分)

- 风险分层评估，基于查询结果，智能体再次调用MySQL查询高血压风险评估表及rag知识库，生成风险等级和随访计划，并展示评估逻辑(5 分)

- 用药冲突检测: 智能体检测患者当前用药是否存在禁忌或相互作用(rag知识库)，展示预警提示 (5 分)

#### 4.2.2. 菜单：个性化诊疗决策（大菜单：个性化诊疗决策）(20 分)

- 诊断推理能力，输入患者症状和检查数据，智能体生成鉴别诊断列表(至少 3 个) 及概率排序, 展示推理路径 (7 分)

- 治疗方案生成，基于患者风险分层和指南推荐，生成个性化治疗方案，包含药物选择、剂量调整依据，截图展示(8 分)

- 动态调整能力:模拟患者治疗2周后效果不佳，智能体重新评估并调整方案，截图展示调整逻辑 (5 分)

#### 4.2.3. 循证医学支持 (10 分)

- 证据等级标注:所有治疗建议标注证据等级(如IA、IIB)，截图展示引用的指南出处和更新时间(5 分)

- 多源知识融合:整合 PDF 指南推荐、Excel 统计数据、MySQL 患者数据，生成综合决策建议，截图展示融合过程(5 分)

#### 4.2.4. 伦理安全控制 (10 分)

- 高风险预警:当检测到患者为孕妇且建议使用ACEI类药物时，智能体主动警示禁忌风险，截图展示(5 分)

- 转诊决策:对高血压急症(SBP>180mmHg)患者，智能体明确建议紧急转诊并说明理由, 截图展示 (5 分)

## 4.3.系统工程能力(20 分)

#### 4.3.1. 智能体对话管理(8 分)

- 结构化问诊:模拟患者主诉"头晕"，智能体按 SOAP 格式进行结构化问诊，截图展示完整对话流程 (4 分)

- 信息澄清能力:当患者信息模糊时，智能体主动追问关键细节(如血压具体数值、 持续时间)，截图展示(4 分)

#### 4.3.2. 系统健壮性(7 分)

- 异常处理:模拟数据库连接失败，智能体优雅降级并提示用户，截图展示(3 分)

- 性能优化:对复杂查询 (如全院患者风险评估) 进行 SQL 优化，响应时间:3 秒， 截图展示执行计划对比(4 分)

#### 4.3.3. 溯源与可解释性(5 分)

- 决策溯源:每个诊疗建议标注数据来源(PDF 页码、Excel 行号、MySQL 表名)， 截图展示高亮标记 (3 分)

- 推理可视化: 使用决策树或流程图展示关键诊疗决策路径, 截图展示 (2 分)

## 4.4.加分项(不计入 100 分，最高+10 分)

- 跨学科协作:处理合并高血压、糖尿病、冠心病的复杂病例，展示多学科诊疗思维 (+3 分)

- 患者教育:生成个性化患者教育材料，适配不同文化程度(+2 分)

- 持续学习:展示指南更新后自动调整诊疗建议的机制(+3 分)

- 临床验证:与真实临床案例对比，展示决策准确性(+2 分)

## 4.5.日志打印

- 关键点都需要打印日志，包含调用大模型、rag操作、数据库查询记录(包含sql)等

## 5.测试案例

测试案例 1: 输入: 患者 ID=1002_0_20210504,

智能体需查询该患者所有数据，发现:

58 岁男性，BMI 28.5 血压 168/98mmHg，诊断为 2 级高血压

合并 2 型糖尿病，HbA1c 8.2%

当前用药:氨氯地平 5mg qd

智能体应输出:联合降压方案+血糖控制建议+3 个月随访计划

测试案例 2: 输入: 患者 ID=1002_0_20210504,

智能体需识别:

35 岁孕妇，血压 158/96mmHg

智能体输出:应禁用 ACEI/ARB，推荐甲基多巴或拉贝洛尔 明确建议产科会诊

测试案例 3:输入:收缩压 190mmHg，头痛呕吐 3 小时，

智能体应输出:

识别为高血压急症

建议立即静脉降压

要求紧急转诊至急诊科

展示 2023 指南相关推荐

## 6.评分说明:

1. 专家智能体占比 55%:体现从基础检索向临床决策支持的转变

2. 循证医学为核心:所有诊疗建议必须基于知识库证据，避免幻觉

3. 安全第一原则:伦理安全评分权重高，确保医疗 AI 的安全性

4. 临床思维路径:重点考察智能体是否具备专家级的临床推理能力，而非简单信息检索

5. 多模态数据融合:要求智能体能够综合文本、表格、数值等多源数据进行决